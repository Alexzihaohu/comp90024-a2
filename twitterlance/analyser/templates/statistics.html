<!DOCTYPE html>
<html lang="en">
<head>
  <!--    Group 39
          Zihao Yang
          Wei Li
          Yuqi Zhang
          Xin Li
          Zihao Hu -->
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Statistics</title>
  <!--import bootstrap and jquery -->
  <link rel="stylesheet" type="text/css" href="../static/css/normalize.css">
  <link rel="stylesheet" href="../static/bootcss/bootstrap.min.css">
  <link rel="stylesheet" href="../static/bootcss/bootstrap-theme.min.css">
  <script src="../static/jquery/jquery.min.js"></script>
  <script src="../static/bootjs/bootstrap.min.js"></script>
  <!--  import chart-->
  <script src="../static/Chart.js/Chart.min.js"></script>
  <script src="../static/Chart.js/samples/utils.js"></script>
  <!--  import style sheet-->
  <link rel="stylesheet" type="text/css" href="../static/css/style.css"/>
  <link rel="stylesheet" href="../static/css/fa/css/all.css">

</head>
<body id="statistics">
  <div class="container">
    <div class="row clearfix">
  <!--    side nav-->
      <div class="col-md-2 column sidenav">
        <img alt="140x140" src="../static/img/unimelb.png" />
        <ul>
          <li>
            <a href="http://localhost:8000/home/">&nbsp<i class="fas fa-home"></i>&nbsp&nbspHome</a>
          </li>
          <li>
            <a href="http://localhost:8000/about/">&nbsp<i class="fas fa-project-diagram"></i>&nbsp&nbspAbout</a>
          </li>
          <li>
            <a href="http://localhost:8000/map/">&nbsp<i class="fas fa-map"></i>&nbsp&nbspMap</a>
          </li>
          <li  class="this">
            <a style="color: #094183" href="http://localhost:8000/statistics/">&nbsp<i class="fas fa-chart-bar"></i>&nbsp&nbspStatistics</a>
          </li>
        </ul>
      </div>
  <!--    content for this page-->
      <div class="col-md-10 column right-content">
        <div class="statistic-right">
          <div class="col-md-12 column">
            <div class="frame">Statistics</div>
            <div class="col-md-4 user">
              <i class="fas fa-user"style="color: #A5DFDF"></i>
              <p>Users:</p>
              <span id="total_user">loading</span>
            </div>
            <div class="col-md-4 tweet" >
              <i class="fab fa-twitter" style="color: #289FF0"></i>
              <p>Tweets:</p>
              <span id="total_tweet">loading</span>
            </div>
            <div class="col-md-4 tweetsport">
              <i class="fas fa-running"  style="color: #D93241"></i>
              <p>Sport related tweets:</p>
              <span id="sportcount">loading</span>
            </div>
          </div>
          <div class="col-md-12 column" style="margin-top: 3%">
            <div class = options>
              <a class = "col-md-3" href="#" id="scenario1">Gender <br> Age</a>
              <a class = "col-md-3" href="#" id="scenario2">Employment <br> Education</a>
              <a class = "col-md-3" href="#" id="scenario3" style="margin-right: 4%;box-shadow:5px 5px 5px #909090;">Income
                <br> tweets frequency</a>
              <a class = "col-md-3" href="#" id="sporttype">Sports rank <br> Sports tweets rank</a>
            </div>
          </div>
          <div class="col-md-12 column statistic-detail" >
            <div class="col-md-6" style="margin-right: 4%">
              <div class="charts">
                <canvas id="Statisticchart1"></canvas>
                <canvas id="Statisticchart2"></canvas>
                <canvas id="Statisticchart3"></canvas>
                <canvas id="Statisticchart4"></canvas>
                <canvas id="Statisticchart5"></canvas>
                <canvas id="Statisticchart6"></canvas>
              </div>
            </div>
            <div class="col-md-6">
              <canvas id="Statisticchart7"></canvas>
              <canvas id="Statisticchart8"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <script>
    window.onload = function () {
      const tuser = document.getElementById('total_user')
      const ttweet = document.getElementById('total_tweet')
      const tsport = document.getElementById('sportcount')

      // ajax request function
      function ajax(url, method, success, error) {
        var request = new XMLHttpRequest();
        // for (var key in header) {
        //   request.setRequestHeader(key, header[key]);
        // }
        request.open(method, url, true);
        request.send();
        request.onreadystatechange = function () {
          if (request.readyState === 4) {
            if (request.status  >= 200 && request.status < 300) {
              success(request.response)
            } else {
              error();
            }
          }
        }
      }

      function showtotal(response){
        ttweet.innerHTML = $.parseJSON(response)["twitter"];
        tuser.innerHTML = eval("("+response+")")["user"];
        tsport.innerHTML = JSON.parse(response)["sport"];
      }

      function error(){
        console.log('error')
      }

      ajax('http://localhost:8000/analyser/tweets/demo/','GET', showtotal, error)


      // var xhr1 = new XMLHttpRequest();
      // xhr1.open('GET', 'http://localhost:8000/analyser/tweets/demotime/', true);
      // xhr1.send();
      // // xhr1.setRequestHeader()
      // xhr1.onreadystatechange = function (){
      //   if (xhr1.readyState === 4){
      //     if(xhr1.status >= 200 && xhr1.status < 300){
      //       //  处理结果 行 头空行 体
      //       // console.log(xhr.status);
      //       // console.log(xhr.statusText);
      //       console.log(xhr.getAllResponseHeaders());
      //       console.log(xhr1.response);
      //     }
      //   }
      // };

      // var xhr = new XMLHttpRequest();
      // // 初始化 true表示异步 false为同步
      // xhr.open('GET', 'http://localhost:8000/analyser/tweets/demo/', true);
      // // 发送
      // xhr.send();
      // // 事件绑定
      // xhr.onreadystatechange = function (){
      //   if (xhr.readyState === 4){
      //     if(xhr.status >= 200 && xhr.status < 300){
      //       //  处理结果 行 头空行 体
      //       // console.log(xhr.status);
      //       // console.log(xhr.statusText);
      //       // console.log(xhr.getAllResponseHeaders());
      //       // console.log(xhr.response);
      //       // 将获取的jsonstr转化为json
      //       // ttweet.innerHTML = xhr.response["twitter"];
      //       ttweet.innerHTML = $.parseJSON(xhr.response)["twitter"];
      //       tuser.innerHTML = eval("("+xhr.response+")")["user"];
      //       tsport.innerHTML = JSON.parse(xhr.response)["sport"];
      //     }
      //   }
      // };

      let canvas = document.getElementsByTagName('canvas')
      let canvas1 = canvas[0];
      let canvas2 = canvas[1];
      let canvas3 = canvas[2];
      let canvas4 = canvas[3];
      let canvas5 = canvas[4];
      let canvas6 = canvas[5];
      let canvas7 = canvas[6];
      let canvas8 = canvas[7];

    //default
      canvas1.className = 'show';
      canvas2.className = 'show';
      canvas3.className = 'hide';
      canvas4.className = 'hide';
      canvas5.className = 'hide';
      canvas6.className = 'hide';
      canvas7.className = 'show';
      canvas8.className = 'show';

      //default chart when the page is refreshed

      let barchartdata1 = [0.49,0.49,0.49,0.49];
      let barcharttitle1 = 'Gender ratio';
      let barchartdata2 = [36,36,39,35];
      let barcharttitle2 = 'Average age';

      let UsersBar1={
        datasets: [{
          data: barchartdata1,
          backgroundColor: [
            'rgba(255, 99, 132, 0.5)',
            'rgba(54, 162, 235, 0.5)',
            'rgba(255, 206, 86, 0.5)',
            'rgba(75, 192, 192, 0.5)',
          ],
          borderColor: [
            'rgba(255,99,132,0.6)',
            'rgba(54, 162, 235, 0.6)',
            'rgba(255, 206, 86, 0.6)',
            'rgba(75, 192, 192, 0.6)',
          ],
          borderWidth: 3
        }],
        labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
      }
      let optionBar1={
        title: {display: true,text: barcharttitle1,fontSize: 30,},
        scales: {yAxes: [{ticks: {beginAtZero:true}}] }
      }

      var Bar1 = canvas1.getContext('2d');
      const Barchart1 = new Chart(Bar1, {type:'bar', data: UsersBar1, options: optionBar1});

      //barchart
      let UsersBar2={
        datasets: [{
          data: barchartdata2,
          backgroundColor: [
            'rgba(255, 99, 132, 0.5)',
            'rgba(54, 162, 235, 0.5)',
            'rgba(255, 206, 86, 0.5)',
            'rgba(75, 192, 192, 0.5)',
          ],
          borderColor: [
            'rgba(255,99,132,0.6)',
            'rgba(54, 162, 235, 0.6)',
            'rgba(255, 206, 86, 0.6)',
            'rgba(75, 192, 192, 0.6)',
          ],
          borderWidth: 3
        }],
        labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
      }
      let optionBar2={
        title: {display: true,text: barcharttitle2,fontSize: 30,},
        scales: {yAxes: [{ticks: {beginAtZero:true}}] }
      }

      var Bar2 = canvas2.getContext('2d');
      const Barchart2 = new Chart(Bar2, {type:'bar', data: UsersBar2, options: optionBar2});


      // default right page includes tweets related status
      let barchartdata7 = [717,672,614,997];
      let barcharttitle7 = 'Total tweets in each city';
      let barchartdata8 = [717,672,614,997];
      let barcharttitle8 = 'Total sport tweets/tweets ratio';

      let UsersBar7={
        datasets: [{
          data: barchartdata7,
          backgroundColor: [
            'rgba(255, 99, 132, 0.5)',
            'rgba(54, 162, 235, 0.5)',
            'rgba(255, 206, 86, 0.5)',
            'rgba(75, 192, 192, 0.5)',
          ],
          borderColor: [
            'rgba(255,99,132,0.6)',
            'rgba(54, 162, 235, 0.6)',
            'rgba(255, 206, 86, 0.6)',
            'rgba(75, 192, 192, 0.6)',
          ],
          borderWidth: 3
        }],
        labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
      }

      let optionBar7={
        title: {display: true,text: barcharttitle7,fontSize: 30,},
        scales: {yAxes: [{ticks: {beginAtZero:true}}] }
      }
      let Bar7 = canvas7.getContext('2d');
      const Barchart7 = new Chart(Bar7, {type:'bar', data: UsersBar7, options: optionBar7});
      //barchart
      let UsersBar8={
        datasets: [{
          data: barchartdata8,
          backgroundColor: [
            'rgba(255, 99, 132, 0.5)',
            'rgba(54, 162, 235, 0.5)',
            'rgba(255, 206, 86, 0.5)',
            'rgba(75, 192, 192, 0.5)',
          ],
          borderColor: [
            'rgba(255,99,132,0.6)',
            'rgba(54, 162, 235, 0.6)',
            'rgba(255, 206, 86, 0.6)',
            'rgba(75, 192, 192, 0.6)',
          ],
          borderWidth: 3
        }],
        labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
      }

      let optionBar8={
        title: {display: true,text: barcharttitle8,fontSize: 30,},
        scales: {yAxes: [{ticks: {beginAtZero:true}}] }
      }
      let Bar8 = canvas8.getContext('2d');
      let Barchart8 = new Chart(Bar8, {type:'bar', data: UsersBar8, options: optionBar8});

      //
    //scenario1
    //
      document.getElementById('scenario1').addEventListener('click', function() {
        // canvas.className = 'hide';
        canvas1.className = 'show';
        canvas2.className = 'show';
        canvas3.className = 'hide';
        canvas4.className = 'hide';
        canvas5.className = 'hide';
        canvas6.className = 'hide';
        let barchartdata1 = [0.49,0.49,0.49,0.49];
        let barcharttitle1 = 'Gender ratio';
        let barchartdata2 = [36,36,39,35];
        let barcharttitle2 = 'Average age';

        let UsersBar1={
          datasets: [{
            data: barchartdata1,
            backgroundColor: [
              'rgba(255, 99, 132, 0.5)',
              'rgba(54, 162, 235, 0.5)',
              'rgba(255, 206, 86, 0.5)',
              'rgba(75, 192, 192, 0.5)',
            ],
            borderColor: [
              'rgba(255,99,132,0.6)',
              'rgba(54, 162, 235, 0.6)',
              'rgba(255, 206, 86, 0.6)',
              'rgba(75, 192, 192, 0.6)',
            ],
            borderWidth: 3
          }],
          labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
        }
        let optionBar1={
          title: {display: true,text: barcharttitle1,fontSize: 30,},
          scales: {yAxes: [{ticks: {beginAtZero:true}}] }
        }

        var Bar1 = canvas1.getContext('2d');
        const Barchart1 = new Chart(Bar1, {type:'bar', data: UsersBar1, options: optionBar1});

        //barchart
        let UsersBar2={
          datasets: [{
            data: barchartdata2,
            backgroundColor: [
              'rgba(255, 99, 132, 0.5)',
              'rgba(54, 162, 235, 0.5)',
              'rgba(255, 206, 86, 0.5)',
              'rgba(75, 192, 192, 0.5)',
            ],
            borderColor: [
              'rgba(255,99,132,0.6)',
              'rgba(54, 162, 235, 0.6)',
              'rgba(255, 206, 86, 0.6)',
              'rgba(75, 192, 192, 0.6)',
            ],
            borderWidth: 3
          }],
          labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
        }
        let optionBar2={
          title: {display: true,text: barcharttitle2,fontSize: 30,},
          scales: {yAxes: [{ticks: {beginAtZero:true}}] }
        }

        var Bar2 = canvas2.getContext('2d');
        const Barchart2 = new Chart(Bar2, {type:'bar', data: UsersBar2, options: optionBar2});
      })

      //
      //scenario2
      //
      document.getElementById('scenario2').addEventListener('click', function() {
        canvas1.className = 'hide';
        canvas2.className = 'hide';
        canvas3.className = 'show';
        canvas4.className = 'show';
        canvas5.className = 'hide';
        canvas6.className = 'hide';
        let barchartdata3 = [6.1,6.8,7.8,4.8];
        let barcharttitle3 = 'Unemployment rate';
        let barchartdata4 = [0.51,0.5,0.48,0.55];
        let barcharttitle4 = 'Educated rate';

        let UsersBar3={
          datasets: [{
            data: barchartdata3,
            backgroundColor: [
              'rgba(255, 99, 132, 0.5)',
              'rgba(54, 162, 235, 0.5)',
              'rgba(255, 206, 86, 0.5)',
              'rgba(75, 192, 192, 0.5)',
            ],
            borderColor: [
              'rgba(255,99,132,0.6)',
              'rgba(54, 162, 235, 0.6)',
              'rgba(255, 206, 86, 0.6)',
              'rgba(75, 192, 192, 0.6)',
            ],
            borderWidth: 3
          }],
          labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
        }

        let optionBar3={
          title: {display: true,text: barcharttitle3,fontSize: 30,},
          scales: {yAxes: [{ticks: {beginAtZero:true}}] }
        }
        var Bar3 = canvas3.getContext('2d');
        const Barchart3 = new Chart(Bar3, {type:'bar', data: UsersBar3, options: optionBar3});
        //barchart
        let UsersBar4={
          datasets: [{
            data: barchartdata4,
            backgroundColor: [
              'rgba(255, 99, 132, 0.5)',
              'rgba(54, 162, 235, 0.5)',
              'rgba(255, 206, 86, 0.5)',
              'rgba(75, 192, 192, 0.5)',
            ],
            borderColor: [
              'rgba(255,99,132,0.6)',
              'rgba(54, 162, 235, 0.6)',
              'rgba(255, 206, 86, 0.6)',
              'rgba(75, 192, 192, 0.6)',
            ],
            borderWidth: 3
          }],
          labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
        }

        let optionBar4={
          title: {display: true,text: barcharttitle4,fontSize: 30,},
          scales: {yAxes: [{ticks: {beginAtZero:true}}] }
        }
        var Bar4 = canvas4.getContext('2d');
        const Barchart4 = new Chart(Bar4, {type:'bar', data: UsersBar4, options: optionBar4});
      })


      //
      //scenario3
      //
      document.getElementById('scenario3').addEventListener('click', function() {
        canvas1.className = 'hide';
        canvas2.className = 'hide';
        canvas3.className = 'hide';
        canvas4.className = 'hide';
        canvas5.className = 'show';
        canvas6.className = 'show';

        let barchartdata5 = [717,672,614,997];
        let barcharttitle5 = 'Average income';
        let barchartdata6 = [717,672,614,997];
        let barcharttitle6 = 'Total user/tweets ratio';

        let UsersBar5={
          datasets: [{
            data: barchartdata5,
            backgroundColor: [
              'rgba(255, 99, 132, 0.5)',
              'rgba(54, 162, 235, 0.5)',
              'rgba(255, 206, 86, 0.5)',
              'rgba(75, 192, 192, 0.5)',
            ],
            borderColor: [
              'rgba(255,99,132,0.6)',
              'rgba(54, 162, 235, 0.6)',
              'rgba(255, 206, 86, 0.6)',
              'rgba(75, 192, 192, 0.6)',
            ],
            borderWidth: 3
          }],
          labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
        }

        let optionBar5={
          title: {display: true,text: barcharttitle5,fontSize: 30,},
          scales: {yAxes: [{ticks: {beginAtZero:true}}] }
        }
        var Bar5 = canvas5.getContext('2d');
        const Barchart5 = new Chart(Bar5, {type:'bar', data: UsersBar5, options: optionBar5});
        //barchart
        let UsersBar6={
          datasets: [{
            data: barchartdata6,
            backgroundColor: [
              'rgba(255, 99, 132, 0.5)',
              'rgba(54, 162, 235, 0.5)',
              'rgba(255, 206, 86, 0.5)',
              'rgba(75, 192, 192, 0.5)',
            ],
            borderColor: [
              'rgba(255,99,132,0.6)',
              'rgba(54, 162, 235, 0.6)',
              'rgba(255, 206, 86, 0.6)',
              'rgba(75, 192, 192, 0.6)',
            ],
            borderWidth: 3
          }],
          labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
        }

        let optionBar6={
          title: {display: true,text: barcharttitle6,fontSize: 30,},
          scales: {yAxes: [{ticks: {beginAtZero:true}}] }
        }
        var Bar6 = canvas6.getContext('2d');
        const Barchart6 = new Chart(Bar6, {type:'bar', data: UsersBar6, options: optionBar6});
      })
      //
      document.getElementById('sporttype').addEventListener('click', function(){

        canvas7.className = 'show';
        canvas8.className = 'show';
        //tweets
        let barchartdata7 = [717,672,614,997];
        let barcharttitle7 = 'Total tweets in each city';
        let barchartdata8 = [717,672,614,997];
        let barcharttitle8 = 'Total sport tweets/tweets ratio';

        let UsersBar7={
          datasets: [{
            data: barchartdata7,
            backgroundColor: [
              'rgba(255, 99, 132, 0.5)',
              'rgba(54, 162, 235, 0.5)',
              'rgba(255, 206, 86, 0.5)',
              'rgba(75, 192, 192, 0.5)',
            ],
            borderColor: [
              'rgba(255,99,132,0.6)',
              'rgba(54, 162, 235, 0.6)',
              'rgba(255, 206, 86, 0.6)',
              'rgba(75, 192, 192, 0.6)',
            ],
            borderWidth: 3
          }],
          labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
        }

        let optionBar7={
          title: {display: true,text: barcharttitle7,fontSize: 30,},
          scales: {yAxes: [{ticks: {beginAtZero:true}}] }
        }
        let Bar9 = canvas7.getContext('2d');
        let Barchart9 = new Chart(Bar9, {type:'bar', data: UsersBar7, options: optionBar7});
        //barchart
        let UsersBar8={
          datasets: [{
            data: barchartdata8,
            backgroundColor: [
              'rgba(255, 99, 132, 0.5)',
              'rgba(54, 162, 235, 0.5)',
              'rgba(255, 206, 86, 0.5)',
              'rgba(75, 192, 192, 0.5)',
            ],
            borderColor: [
              'rgba(255,99,132,0.6)',
              'rgba(54, 162, 235, 0.6)',
              'rgba(255, 206, 86, 0.6)',
              'rgba(75, 192, 192, 0.6)',
            ],
            borderWidth: 3
          }],
          labels: ["Sydney", "Melbourne", "Adelaide", "Canberra"]
        }

        let optionBar8={
          title: {display: true,text: barcharttitle8,fontSize: 30,},
          scales: {yAxes: [{ticks: {beginAtZero:true}}] }
        }
        let Bar10 = canvas8.getContext('2d');
        let Barchart10 = new Chart(Bar10, {type:'bar', data: UsersBar8, options: optionBar8});
    })
    }
  </script>
</body>
</html>
